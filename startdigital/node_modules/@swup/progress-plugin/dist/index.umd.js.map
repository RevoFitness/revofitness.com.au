{"version":3,"file":"index.umd.js","sources":["../node_modules/@swup/plugin/dist/index.modern.js","../src/ProgressBar.js","../src/index.js"],"sourcesContent":["const r=r=>String(r).split(\".\").concat([\"0\",\"0\"]).slice(0,3).join(\".\");class n{constructor(){this.isSwupPlugin=!0,this.requires={},this.swup=void 0,this.version=void 0}mount(){}unmount(){}_beforeMount(){if(!this.name)throw new Error(\"You must define a name of plugin when creating a class.\")}_afterUnmount(){}_checkRequirements(){return\"object\"!=typeof this.requires||Object.entries(this.requires).forEach(([n,e])=>{if(!function(n,e,t){const i=function(r,n){var e;if(\"swup\"===r)return null!=(e=n.version)?e:\"\";{var t;const e=n.findPlugin(r);return null!=(t=null==e?void 0:e.version)?t:\"\"}}(n,t);return!!i&&((n,e)=>e.every(e=>{const[,t,i]=e.match(/^([\\D]+)?(.*)$/)||[];var s,o;return((r,n)=>{const e={\"\":r=>0===r,\">\":r=>r>0,\">=\":r=>r>=0,\"<\":r=>r<0,\"<=\":r=>r<=0};return(e[n]||e[\"\"])(r)})((o=i,s=r(s=n),o=r(o),s.localeCompare(o,void 0,{numeric:!0})),t||\">=\")}))(i,e)}(n,e=Array.isArray(e)?e:[e],this.swup)){const r=`${n} ${e.join(\", \")}`;throw new Error(`Plugin version mismatch: ${this.name} requires ${r}`)}}),!0}}export{n as default};\n//# sourceMappingURL=index.modern.js.map\n","export default class ProgressBar {\n\tstyleElement = null;\n\tprogressElement = null;\n\n\tvalue = 0;\n\tvisible = false;\n\thiding = false;\n\ttrickleInterval = null;\n\n\tconstructor({\n\t\tclassName = 'progress-bar',\n\t\tstyleAttr = 'data-progressbar-styles',\n\t\tanimationDuration = 300,\n\t\tminValue = 0.1,\n\t\tinitialValue = 0.25,\n\t\ttrickleValue = 0.03\n\t} = {}) {\n\t\tthis.className = className;\n\t\tthis.styleAttr = styleAttr;\n\t\tthis.animationDuration = animationDuration;\n\t\tthis.minValue = minValue;\n\t\tthis.initialValue = initialValue;\n\t\tthis.trickleValue = trickleValue;\n\n\t\tthis.styleElement = this.createStyleElement();\n\t\tthis.progressElement = this.createProgressElement();\n\t}\n\n\tget defaultStyles() {\n\t\treturn `\n\t\t.${this.className} {\n\t\t\t\tposition: fixed;\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\tbackground-color: black;\n\t\t\t\tz-index: 9999;\n\t\t\t\ttransition:\n\t\t\t\t\twidth ${this.animationDuration}ms ease-out,\n\t\t\t\t\topacity ${this.animationDuration / 2}ms ${this.animationDuration / 2}ms ease-in;\n\t\t\t\ttransform: translate3d(0, 0, 0);\n\t\t\t}\n\t\t`;\n\t}\n\n\tshow() {\n\t\tif (!this.visible) {\n\t\t\tthis.visible = true;\n\t\t\tthis.installStyleElement();\n\t\t\tthis.installProgressElement();\n\t\t\tthis.startTrickling();\n\t\t}\n\t}\n\n\thide() {\n\t\tif (this.visible && !this.hiding) {\n\t\t\tthis.hiding = true;\n\t\t\tthis.fadeProgressElement(() => {\n\t\t\t\tthis.uninstallProgressElement();\n\t\t\t\tthis.stopTrickling();\n\t\t\t\tthis.visible = false;\n\t\t\t\tthis.hiding = false;\n\t\t\t});\n\t\t}\n\t}\n\n\tsetValue(value) {\n\t\tthis.value = Math.min(1, Math.max(this.minValue, value));\n\t\tthis.refresh();\n\t}\n\n\t// Private\n\n\tinstallStyleElement() {\n\t\tdocument.head.insertBefore(this.styleElement, document.head.firstChild);\n\t}\n\n\tinstallProgressElement() {\n\t\tthis.progressElement.style.width = '0%';\n\t\tthis.progressElement.style.opacity = '1';\n\t\tdocument.documentElement.insertBefore(this.progressElement, document.body);\n\t\tthis.progressElement.scrollTop = 0; // Force reflow to ensure initial style takes effect\n\t\tthis.setValue(Math.random() * this.initialValue);\n\t}\n\n\tfadeProgressElement(callback) {\n\t\tthis.progressElement.style.opacity = '0';\n\t\tsetTimeout(callback, this.animationDuration * 1.5);\n\t}\n\n\tuninstallProgressElement() {\n\t\tif (this.progressElement.parentNode) {\n\t\t\tdocument.documentElement.removeChild(this.progressElement);\n\t\t}\n\t}\n\n\tstartTrickling() {\n\t\tif (!this.trickleInterval) {\n\t\t\tthis.trickleInterval = window.setInterval(this.trickle, this.animationDuration);\n\t\t}\n\t}\n\n\tstopTrickling() {\n\t\twindow.clearInterval(this.trickleInterval);\n\t\tdelete this.trickleInterval;\n\t}\n\n\ttrickle = () => {\n\t\tconst advance = Math.random() * this.trickleValue;\n\t\tthis.setValue(this.value + advance);\n\t};\n\n\trefresh() {\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.progressElement.style.width = `${this.value * 100}%`;\n\t\t});\n\t}\n\n\tcreateStyleElement() {\n\t\tconst element = document.createElement('style');\n\t\telement.setAttribute(this.styleAttr, '');\n\t\telement.textContent = this.defaultStyles;\n\t\treturn element;\n\t}\n\n\tcreateProgressElement() {\n\t\tconst element = document.createElement('div');\n\t\telement.className = this.className;\n\t\treturn element;\n\t}\n}\n","import Plugin from '@swup/plugin';\nimport ProgressBar from './ProgressBar';\n\nexport default class SwupProgressPlugin extends Plugin {\n\tname = 'SwupProgressPlugin';\n\n\tconstructor(options = {}) {\n\t\tsuper();\n\t\tconst defaultOptions = {\n\t\t\tclassName: 'swup-progress-bar',\n\t\t\tdelay: 300,\n\t\t\ttransition: undefined,\n\t\t\tminValue: undefined,\n\t\t\tinitialValue: undefined,\n\t\t\thideImmediately: true\n\t\t};\n\n\t\tthis.options = {\n\t\t\t...defaultOptions,\n\t\t\t...options\n\t\t};\n\n\t\tthis.showProgressBarTimeout = null;\n\t\tthis.hideProgressBarTimeout = null;\n\n\t\tthis.progressBar = new ProgressBar({\n\t\t\tclassName: this.options.className,\n\t\t\tanimationDuration: this.options.transition,\n\t\t\tminValue: this.options.minValue,\n\t\t\tinitialValue: this.options.initialValue\n\t\t});\n\t}\n\n\tmount() {\n\t\tthis.swup.on('transitionStart', this.startShowingProgress);\n\t\tthis.swup.on('contentReplaced', this.stopShowingProgress);\n\t}\n\n\tunmount() {\n\t\tthis.swup.off('transitionStart', this.startShowingProgress);\n\t\tthis.swup.off('contentReplaced', this.stopShowingProgress);\n\t}\n\n\tstartShowingProgress = () => {\n\t\tthis.progressBar.setValue(0);\n\t\tthis.showProgressBarAfterDelay();\n\t};\n\n\tstopShowingProgress = () => {\n\t\tthis.progressBar.setValue(1);\n\t\tif (this.options.hideImmediately) {\n\t\t\tthis.hideProgressBar();\n\t\t} else {\n\t\t\tthis.finishAnimationAndHideProgressBar();\n\t\t}\n\t};\n\n\tshowProgressBar = () => {\n\t\tthis.cancelHideProgressBarTimeout();\n\t\tthis.progressBar.show();\n\t};\n\n\tshowProgressBarAfterDelay = () => {\n\t\tthis.cancelShowProgressBarTimeout();\n\t\tthis.cancelHideProgressBarTimeout();\n\t\tthis.showProgressBarTimeout = window.setTimeout(this.showProgressBar, this.options.delay);\n\t};\n\n\thideProgressBar = () => {\n\t\tthis.cancelShowProgressBarTimeout();\n\t\tthis.progressBar.hide();\n\t};\n\n\tfinishAnimationAndHideProgressBar = () => {\n\t\tthis.cancelShowProgressBarTimeout();\n\t\tthis.hideProgressBarTimeout = window.setTimeout(this.hideProgressBar, this.options.transition);\n\t};\n\n\tcancelShowProgressBarTimeout = () => {\n\t\twindow.clearTimeout(this.showProgressBarTimeout);\n\t\tdelete this.showProgressBarTimeout;\n\t};\n\n\tcancelHideProgressBarTimeout = () => {\n\t\twindow.clearTimeout(this.hideProgressBarTimeout);\n\t\tdelete this.hideProgressBarTimeout;\n\t};\n}\n"],"names":["r","String","split","concat","slice","join","n","constructor","this","isSwupPlugin","requires","swup","version","mount","unmount","_beforeMount","name","Error","_afterUnmount","_checkRequirements","Object","entries","forEach","e","t","i","findPlugin","every","match","s","o","localeCompare","numeric","Array","isArray","ProgressBar","_temp","className","styleAttr","animationDuration","minValue","initialValue","trickleValue","styleElement","progressElement","value","visible","hiding","trickleInterval","trickle","advance","Math","random","setValue","createStyleElement","createProgressElement","defaultStyles","show","installStyleElement","installProgressElement","startTrickling","hide","fadeProgressElement","uninstallProgressElement","stopTrickling","min","max","refresh","document","head","insertBefore","firstChild","style","width","opacity","documentElement","body","scrollTop","callback","setTimeout","parentNode","removeChild","window","setInterval","clearInterval","requestAnimationFrame","element","createElement","setAttribute","textContent","Plugin","options","super","startShowingProgress","progressBar","showProgressBarAfterDelay","stopShowingProgress","hideImmediately","hideProgressBar","finishAnimationAndHideProgressBar","showProgressBar","cancelHideProgressBarTimeout","cancelShowProgressBarTimeout","showProgressBarTimeout","delay","hideProgressBarTimeout","transition","clearTimeout","undefined","on","off"],"mappings":"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"}
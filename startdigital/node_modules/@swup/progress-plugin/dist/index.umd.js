!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t||self).SwupProgressPlugin=e()}(this,function(){const t=t=>String(t).split(".").concat(["0","0"]).slice(0,3).join(".");class e{constructor(){this.isSwupPlugin=!0,this.requires={},this.swup=void 0,this.version=void 0}mount(){}unmount(){}_beforeMount(){if(!this.name)throw new Error("You must define a name of plugin when creating a class.")}_afterUnmount(){}_checkRequirements(){return"object"!=typeof this.requires||Object.entries(this.requires).forEach(([e,s])=>{if(!function(e,s,i){const r=function(t,e){var s;if("swup"===t)return null!=(s=e.version)?s:"";{var i;const s=e.findPlugin(t);return null!=(i=null==s?void 0:s.version)?i:""}}(e,i);return!!r&&((e,s)=>s.every(s=>{const[,i,r]=s.match(/^([\D]+)?(.*)$/)||[];var n,o;return((t,e)=>{const s={"":t=>0===t,">":t=>t>0,">=":t=>t>=0,"<":t=>t<0,"<=":t=>t<=0};return(s[e]||s[""])(t)})((o=r,n=t(n=e),o=t(o),n.localeCompare(o,void 0,{numeric:!0})),i||">=")}))(r,s)}(e,s=Array.isArray(s)?s:[s],this.swup)){const t=`${e} ${s.join(", ")}`;throw new Error(`Plugin version mismatch: ${this.name} requires ${t}`)}}),!0}}class s{constructor(t){let{className:e="progress-bar",styleAttr:s="data-progressbar-styles",animationDuration:i=300,minValue:r=.1,initialValue:n=.25,trickleValue:o=.03}=void 0===t?{}:t;this.styleElement=null,this.progressElement=null,this.value=0,this.visible=!1,this.hiding=!1,this.trickleInterval=null,this.trickle=()=>{const t=Math.random()*this.trickleValue;this.setValue(this.value+t)},this.className=e,this.styleAttr=s,this.animationDuration=i,this.minValue=r,this.initialValue=n,this.trickleValue=o,this.styleElement=this.createStyleElement(),this.progressElement=this.createProgressElement()}get defaultStyles(){return`\n\t\t.${this.className} {\n\t\t\t\tposition: fixed;\n\t\t\t\tdisplay: block;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\theight: 3px;\n\t\t\t\tbackground-color: black;\n\t\t\t\tz-index: 9999;\n\t\t\t\ttransition:\n\t\t\t\t\twidth ${this.animationDuration}ms ease-out,\n\t\t\t\t\topacity ${this.animationDuration/2}ms ${this.animationDuration/2}ms ease-in;\n\t\t\t\ttransform: translate3d(0, 0, 0);\n\t\t\t}\n\t\t`}show(){this.visible||(this.visible=!0,this.installStyleElement(),this.installProgressElement(),this.startTrickling())}hide(){this.visible&&!this.hiding&&(this.hiding=!0,this.fadeProgressElement(()=>{this.uninstallProgressElement(),this.stopTrickling(),this.visible=!1,this.hiding=!1}))}setValue(t){this.value=Math.min(1,Math.max(this.minValue,t)),this.refresh()}installStyleElement(){document.head.insertBefore(this.styleElement,document.head.firstChild)}installProgressElement(){this.progressElement.style.width="0%",this.progressElement.style.opacity="1",document.documentElement.insertBefore(this.progressElement,document.body),this.progressElement.scrollTop=0,this.setValue(Math.random()*this.initialValue)}fadeProgressElement(t){this.progressElement.style.opacity="0",setTimeout(t,1.5*this.animationDuration)}uninstallProgressElement(){this.progressElement.parentNode&&document.documentElement.removeChild(this.progressElement)}startTrickling(){this.trickleInterval||(this.trickleInterval=window.setInterval(this.trickle,this.animationDuration))}stopTrickling(){window.clearInterval(this.trickleInterval),delete this.trickleInterval}refresh(){requestAnimationFrame(()=>{this.progressElement.style.width=100*this.value+"%"})}createStyleElement(){const t=document.createElement("style");return t.setAttribute(this.styleAttr,""),t.textContent=this.defaultStyles,t}createProgressElement(){const t=document.createElement("div");return t.className=this.className,t}}return class extends e{constructor(t){void 0===t&&(t={}),super(),this.name="SwupProgressPlugin",this.startShowingProgress=()=>{this.progressBar.setValue(0),this.showProgressBarAfterDelay()},this.stopShowingProgress=()=>{this.progressBar.setValue(1),this.options.hideImmediately?this.hideProgressBar():this.finishAnimationAndHideProgressBar()},this.showProgressBar=()=>{this.cancelHideProgressBarTimeout(),this.progressBar.show()},this.showProgressBarAfterDelay=()=>{this.cancelShowProgressBarTimeout(),this.cancelHideProgressBarTimeout(),this.showProgressBarTimeout=window.setTimeout(this.showProgressBar,this.options.delay)},this.hideProgressBar=()=>{this.cancelShowProgressBarTimeout(),this.progressBar.hide()},this.finishAnimationAndHideProgressBar=()=>{this.cancelShowProgressBarTimeout(),this.hideProgressBarTimeout=window.setTimeout(this.hideProgressBar,this.options.transition)},this.cancelShowProgressBarTimeout=()=>{window.clearTimeout(this.showProgressBarTimeout),delete this.showProgressBarTimeout},this.cancelHideProgressBarTimeout=()=>{window.clearTimeout(this.hideProgressBarTimeout),delete this.hideProgressBarTimeout},this.options={className:"swup-progress-bar",delay:300,transition:void 0,minValue:void 0,initialValue:void 0,hideImmediately:!0,...t},this.showProgressBarTimeout=null,this.hideProgressBarTimeout=null,this.progressBar=new s({className:this.options.className,animationDuration:this.options.transition,minValue:this.options.minValue,initialValue:this.options.initialValue})}mount(){this.swup.on("transitionStart",this.startShowingProgress),this.swup.on("contentReplaced",this.stopShowingProgress)}unmount(){this.swup.off("transitionStart",this.startShowingProgress),this.swup.off("contentReplaced",this.stopShowingProgress)}}});
//# sourceMappingURL=index.umd.js.map
